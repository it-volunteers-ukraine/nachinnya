<?php
$default_classes = [
    'title-template-part' => 'title-template-part',
    'animation-container' => 'animation-container',
    'ball-container' => 'ball-container',
    'path-container' => 'path-container',
    'content-container' => 'content-container',

];

$modules_file = get_template_directory() . '/assets/blocks/styles/modules.json';
$classes = $default_classes;

if (file_exists($modules_file)) {
    $modules = json_decode(file_get_contents($modules_file), true);
    $classes = array_merge($default_classes, $modules['history-section-block'] ?? []);
}
?>

<section class='section'>
    <div class='container'>
        <!-- h2_title -->
        <?php
            $h2_title = get_field('h2_title');
            if (!empty($h2_title)) : 
        ?>
            <div class="<?php echo esc_attr($classes['title-template-part']); ?>">
                <?php get_template_part('template-parts/h2-title'); ?>
            </div>
        <?php endif; ?>
        <!-- content with animation -->
        <div class="<?php echo esc_attr($classes['content-with-animation-wrapper']); ?>">
            <!-- ball + path -->
            <div class="<?php echo esc_attr($classes['animation-container']); ?>">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
                <div class="<?php echo esc_attr($classes['ball-container']); ?>">
                    <svg id='ball' width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.0744 11.651C17.1051 11.4578 17.3296 11.6987 17.4021 11.7551C18.218 12.3907 18.697 13.077 18.8574 14.0541C19.0402 15.1681 19.0727 16.4133 18.9345 17.5329C18.7663 18.8954 17.7991 19.7079 16.6889 20.5519C14.5758 22.1584 12.6526 23.6848 9.73039 23.6317C6.5511 23.5738 5.25084 20.3706 5.32591 17.8365C5.43732 14.0757 11.5328 13.409 14.6264 13.3688C17.2977 13.334 19.5961 13.4233 20.1585 16.1102C20.6008 18.2232 18.4229 19.1118 16.3227 19.1118C15.1994 19.1118 14.5333 18.6292 13.9903 17.7758C13.744 17.3887 13.1247 16.5233 13.3928 16.0408C14.0354 14.8839 15.968 15.4813 16.1299 16.596C16.6106 19.9048 12.0607 20.5784 9.60509 18.973C8.16129 18.0291 7.6251 16.4339 7.44623 14.9043C7.34279 14.0198 7.29162 13.1516 7.6679 12.3017C8.40609 10.6342 10.3348 10.4183 12.1206 10.558C15.3193 10.8081 20.1764 12.0866 22.0764 14.6787C23.1717 16.173 21.9983 17.8858 20.4862 18.6954C18.6557 19.6755 16.1595 19.7849 14.2023 19.0424C11.1982 17.9027 8.2525 13.9039 9.89423 10.9483C11.8225 7.47691 18.5128 8.88231 20.9488 11.0264C24.0711 13.7746 23.6361 19.6645 21.556 22.7902C19.9348 25.2262 16.7688 25.5776 14.0096 24.6553C9.57421 23.1729 6.12249 19.3125 4.75728 15.312C3.50308 11.6368 3.46315 6.3091 6.54991 3.28804C8.35565 1.52073 11.1679 1.79315 13.3349 2.78487C16.1243 4.06136 18.0161 6.39383 19.0116 9.02243C20.0914 11.8735 20.5732 16.0162 18.4044 18.5566C15.7765 21.6347 10.643 23.0139 6.66556 21.2373C4.23895 20.1533 3.35352 18.0911 3.09957 15.7805C2.76842 12.7675 3.17129 9.99364 5.72106 7.82523C9.31242 4.77102 14.1406 4.39987 18.8285 4.65874C22.4053 4.85626 23.9386 9.02208 24.5533 11.7031C25.0819 14.0083 25.339 17.1504 24.1775 19.3461C23.2162 21.1631 21.9057 22.6426 20.3031 24.0394C18.4736 25.6339 16.6086 26.1831 14.0481 25.948C10.5002 25.6221 7.01136 23.7088 5.79816 20.604C4.30588 16.7849 4.5821 12.8879 8.41964 10.3497C10.8632 8.73361 14.4761 7.4654 17.5467 7.74715C21.6787 8.12631 23.4972 11.8616 24.0522 15.1385C24.3962 17.1698 24.4659 19.9947 22.7414 21.6103C20.87 23.3636 17.4344 23.0249 15.2143 22.1655C12.733 21.205 9.08458 19.0446 8.40037 16.4745C7.86524 14.4644 10.6056 14.0671 12.1398 14.5052C14.0229 15.043 15.6114 16.5739 15.9371 18.3484C16.3011 20.3312 14.2143 20.3491 12.7374 19.7017C12.1394 19.4397 10.4429 18.4218 11.6772 17.8539C12.3398 17.5491 12.9283 17.6193 13.6048 17.7411" stroke="#B74028" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <!-- <div class="<?php echo esc_attr($classes['path-container']); ?>">
                    <svg width="394" height="2719" viewBox="0 0 394 2719" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path id='trajectory' d="M114.5 1352.5C-37.5001 1385.5 -42.46 1653.26 162.054 1673.76M162.054 1673.76C180 1678.5 198.569 1666.53 192 1655C185.579 1643.73 158.5 1655.5 162.054 1673.76ZM162.054 1673.76C-14.4999 1875 162.054 2021.01 321.483 2042.79M321.483 2042.79C346.987 2053.01 349.874 2046.88 353.243 2042.79C360.461 2040.07 363.829 1994.46 332.551 2000.59C315.811 2008.22 316.671 2022.37 321.483 2042.79ZM321.483 2042.79C418.594 2189.4 388.977 2200.98 136.5 2226.5C49.0801 2238.75 20.0005 2257.5 16.5005 2317.5C16.5005 2376 -9.15889 2507.11 156.086 2517.2M13.4606 0.5C-7.30271 69.1415 3.12083 263.252 172.582 278.098M172.582 278.098C186.124 278.098 198.338 271.755 192.895 263.402C187.575 255.237 178.386 263.402 172.582 278.098ZM172.582 278.098C156.621 362.466 172.582 529.622 304.685 545.402M304.685 545.402C325.818 552.799 328.21 548.361 331.001 545.402C336.982 543.43 339.773 510.39 313.856 514.829C299.986 520.361 300.698 530.609 304.685 545.402ZM304.685 545.402C369.384 630.785 182.003 564.5 28.003 664.5C-31.8202 739.509 7.75038 902.134 165.919 912.227M156.086 2517.2C169.291 2517.2 181.201 2512.89 175.893 2507.21C170.706 2501.66 161.745 2507.21 156.086 2517.2ZM156.086 2517.2C140.522 2574.55 156.086 2688.17 284.902 2698.9M284.902 2698.9C305.509 2703.93 307.842 2700.91 310.563 2698.9C316.395 2697.56 328.273 2677.98 303 2681C289.475 2684.76 281.014 2688.84 284.902 2698.9ZM284.902 2698.9C264.5 2714.5 218 2718 200 2718M165.919 912.227C178.559 912.227 189.96 907.915 184.879 902.236C179.914 896.685 171.337 902.236 165.919 912.227ZM165.919 912.227C151.022 969.583 165.92 1083.22 289.22 1093.95M289.22 1093.95C308.945 1098.98 311.178 1095.96 313.783 1093.95C319.365 1092.61 330.734 1073.03 306.543 1076.05C294.1 1078.55 294.1 1084.55 289.22 1093.95ZM289.22 1093.95C264.73 1107.14 339.088 1172.56 306.543 1211.56C273.999 1250.57 363.783 1305.07 363.783 1305.07M363.783 1305.07C375.678 1317.21 384.78 1311.07 389.088 1305.07C393.395 1299.07 393.874 1292.57 389.088 1288.57C384.302 1284.57 373.165 1284.58 363.783 1305.07ZM363.783 1305.07L114.15 1352.58" stroke="#B74028" stroke-width="2" stroke-dasharray="4 4"/>
                    </svg>
                </div> -->
                <!-- My line: -->
                <div class="<?php echo esc_attr($classes['path-container']); ?>">
                    <svg width="442" height="2778" viewBox="0 0 442 2778" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path id='trajectory' d="M39.5691 1.50974C37.4195 20.8557 22.2219 35.5903 17.8687 54.0914C15.11 65.8159 16.4843 77.0901 13.2782 88.3113C8.93498 103.513 5.76653 117.374 5.76653 132.964C5.76653 140.476 5.76653 147.987 5.76653 155.499C5.76653 168.386 11.874 168.645 16.1994 178.869C32.7608 218.014 59.4349 250.899 89.6469 281.111C113.346 304.81 147.561 318.126 176.866 334.11C190.271 341.422 203.579 339.535 219.015 339.535C236.204 339.535 238.628 322.812 238.628 307.402C238.628 299.197 231.789 239.092 213.172 253.985C192.874 270.224 197.314 292.279 197.314 317C197.314 328.893 197.314 340.787 197.314 352.68C197.314 365.991 204.356 376.518 204.826 389.196C205.323 402.623 211.534 415.206 212.338 429.675C212.977 441.192 223.565 458.898 229.239 469.111C241.635 491.424 262.569 505.876 273.266 528.161C278.936 539.975 298.046 544.57 303.312 556.539C307.441 565.922 334.12 570.821 343.792 574.275C370.21 583.71 373.839 541.407 373.839 523.571C373.839 495.621 352.407 488.725 344 518.146C337.258 541.745 342.018 571.693 331.69 594.932C324.789 610.459 301.683 616.986 287.454 623.309C270.601 630.8 249.859 638.522 231.534 643.758C219.615 647.163 202.944 651.953 191.889 657.112C172.275 666.265 149.82 667.792 129.709 677.56C100.478 691.758 73.9479 693.721 52.9231 720.752C37.795 740.203 46.3844 789.094 47.0807 812.77C47.863 839.367 73.6732 867.872 94.446 882.253C118.031 898.581 145.784 904.479 171.023 917.099C183.976 923.575 238.628 936.95 238.628 916.056C238.628 890.161 218.09 869.108 189.803 869.108C170.009 869.108 159.756 928.266 159.756 944.016C159.756 973.071 154.707 1005.89 166.433 1032.28C170.543 1041.53 167.741 1053.47 178.535 1059.82C190.841 1067.06 206.791 1069.95 218.389 1077.97C242.893 1094.94 279.229 1092.43 304.147 1104.89C314.461 1110.05 380.659 1109.76 386.775 1103.64C403.579 1086.84 349.216 1040.35 331.69 1059.82C311.005 1082.8 298.722 1092.5 298.722 1126.59C298.722 1160.73 319.297 1182.57 327.934 1211.72C332.13 1225.89 328.527 1243.26 324.178 1256.79C318.215 1275.34 317.501 1288.23 317.501 1308.54C317.501 1337.08 326.179 1343.02 349.008 1358.83C360.195 1366.57 381.93 1354.07 391.783 1361.96C411.614 1377.82 435.605 1344.19 437.479 1327.32C439.886 1305.66 446.02 1300.4 420.995 1297.06C402.479 1294.6 382.999 1282.36 366.327 1297.27C359.222 1303.63 347.549 1306.34 339.201 1311.46C327.62 1318.57 318.356 1326.52 306.233 1332.75C288.033 1342.09 269.977 1350.2 251.774 1358.83C237.571 1365.55 207.408 1376.15 191.472 1376.15C171.068 1376.15 161.176 1388.59 141.811 1391.17C113.347 1394.96 72.4065 1432.13 66.0686 1460.65C59.5378 1490.04 56.8031 1529.48 68.7811 1556.43C84.1955 1591.11 75.3007 1635.36 101.54 1667.43C111.83 1680.01 123.098 1695.09 135.134 1706.03C153.658 1722.87 169.739 1720.86 192.724 1721.68C209.131 1722.27 222.873 1730.94 237.794 1719.6C250.186 1710.18 256.538 1688.58 267.006 1676.61C270.89 1672.17 281.976 1633.55 273.892 1631.75C263.262 1629.39 232.3 1627.85 223.605 1635.3C208.58 1648.18 188.928 1656.33 172.693 1668.27C156.055 1680.5 154.74 1693.52 143.063 1708.54C120.405 1737.67 126.951 1766.27 119.276 1798.89C112.665 1826.98 111.969 1856.73 122.197 1884.85C126.148 1895.72 139.481 1905.46 146.402 1914.9C151.378 1921.69 150.776 1928.49 157.669 1932.43C161.468 1934.6 171.683 1948.62 174.779 1952.88C179.121 1958.85 184.827 1963.12 190.637 1967.48C215.671 1986.26 223.556 2016.86 259.286 2022.36C269.253 2023.89 278.162 2031.47 287.454 2035.09C295.591 2038.25 304.303 2036.09 311.867 2041.14C324.777 2049.74 343.369 2057.22 357.981 2062.63C374.701 2068.82 391.356 2058.8 406.806 2055.12C428.584 2049.93 426.613 2022.64 430.385 2005.67C433.155 1993.2 429.255 1995.86 414.944 1995.86C394.603 1995.86 375.329 1999.61 355.059 1999.61C262.257 1999.61 375.849 2119.43 373.839 2153.6C373.659 2156.66 365.222 2170.95 363.406 2173.22C356.253 2182.16 353.192 2196.37 341.705 2202.64C324.655 2211.94 312.223 2225.93 293.088 2232.69C270.356 2240.71 250.524 2255.46 225.692 2259.6C202.204 2263.52 173.91 2257.11 153.079 2270.04C135.319 2281.06 120.07 2285.44 103.836 2299.87C72.2033 2327.99 72.0384 2373.18 51.6712 2406.08C38.4315 2427.47 22.2637 2474.02 30.1795 2499.35C43.816 2542.99 76.3235 2566.75 122.197 2566.75C141.659 2566.75 198.438 2570.14 204.617 2542.33C207.312 2530.21 214.319 2525.74 212.129 2510.41C207.408 2477.36 155.324 2498.22 138.055 2505.82C127.003 2510.68 122.197 2528.59 122.197 2539.62C122.197 2554.23 114.984 2593.93 124.493 2605.56C137.441 2621.38 188.527 2638.11 208.373 2638.11C217.018 2638.11 240.946 2633.4 242.384 2645.62C244.426 2662.97 247.463 2673.15 236.542 2689.85C224.61 2708.1 208.779 2725.43 187.299 2732.21C147.63 2744.74 102.278 2758.29 60.4348 2758.29C49.6787 2758.29 40.1092 2758.2 29.9708 2762.26C23.662 2764.78 6.08798 2781.47 2.0107 2773.32" stroke="black" stroke-width="3" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
            <!-- content -->
            <div class="<?php echo esc_attr($classes['content-container']); ?>">
                <div class="<?php echo esc_attr($classes['point1']); ?>">
                    <h3 id='year2022' class="<?php echo esc_attr($classes['year2022']); ?>">2022</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point2']); ?>">
                    <h3 id='year2023' class="<?php echo esc_attr($classes['year2023']); ?>">2023</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point3']); ?>">
                    <h3 id='year2024' class="<?php echo esc_attr($classes['year2024']); ?>">2024</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point4']); ?>">
                    <h3 id='year2025' class="<?php echo esc_attr($classes['year2025']); ?>">2025</h3>
                </div>
            </div>
        </div>
    </div>
</section>