<?php
$default_classes = [
    'title-template-part' => 'title-template-part',
    'animation-container' => 'animation-container',
    'ball-container' => 'ball-container',
    'path-container' => 'path-container',
    'content-container' => 'content-container',

];

$modules_file = get_template_directory() . '/assets/blocks/styles/modules.json';
$classes = $default_classes;

if (file_exists($modules_file)) {
    $modules = json_decode(file_get_contents($modules_file), true);
    $classes = array_merge($default_classes, $modules['history-section-block'] ?? []);
}
?>

<section class='section'>
    <div class='container'>
        <!-- h2_title -->
        <?php
            $h2_title = get_field('h2_title');
            if (!empty($h2_title)) : 
        ?>
            <div class="<?php echo esc_attr($classes['title-template-part']); ?>">
                <?php get_template_part('template-parts/h2-title'); ?>
            </div>
        <?php endif; ?>
        <!-- content with animation -->
        <div class="<?php echo esc_attr($classes['content-with-animation-wrapper']); ?>">
            <!-- ball + path -->
            <div class="<?php echo esc_attr($classes['animation-container']); ?>">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
                <div class="<?php echo esc_attr($classes['ball-container']); ?>">
                    <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.0744 11.651C17.1051 11.4578 17.3296 11.6987 17.4021 11.7551C18.218 12.3907 18.697 13.077 18.8574 14.0541C19.0402 15.1681 19.0727 16.4133 18.9345 17.5329C18.7663 18.8954 17.7991 19.7079 16.6889 20.5519C14.5758 22.1584 12.6526 23.6848 9.73039 23.6317C6.5511 23.5738 5.25084 20.3706 5.32591 17.8365C5.43732 14.0757 11.5328 13.409 14.6264 13.3688C17.2977 13.334 19.5961 13.4233 20.1585 16.1102C20.6008 18.2232 18.4229 19.1118 16.3227 19.1118C15.1994 19.1118 14.5333 18.6292 13.9903 17.7758C13.744 17.3887 13.1247 16.5233 13.3928 16.0408C14.0354 14.8839 15.968 15.4813 16.1299 16.596C16.6106 19.9048 12.0607 20.5784 9.60509 18.973C8.16129 18.0291 7.6251 16.4339 7.44623 14.9043C7.34279 14.0198 7.29162 13.1516 7.6679 12.3017C8.40609 10.6342 10.3348 10.4183 12.1206 10.558C15.3193 10.8081 20.1764 12.0866 22.0764 14.6787C23.1717 16.173 21.9983 17.8858 20.4862 18.6954C18.6557 19.6755 16.1595 19.7849 14.2023 19.0424C11.1982 17.9027 8.2525 13.9039 9.89423 10.9483C11.8225 7.47691 18.5128 8.88231 20.9488 11.0264C24.0711 13.7746 23.6361 19.6645 21.556 22.7902C19.9348 25.2262 16.7688 25.5776 14.0096 24.6553C9.57421 23.1729 6.12249 19.3125 4.75728 15.312C3.50308 11.6368 3.46315 6.3091 6.54991 3.28804C8.35565 1.52073 11.1679 1.79315 13.3349 2.78487C16.1243 4.06136 18.0161 6.39383 19.0116 9.02243C20.0914 11.8735 20.5732 16.0162 18.4044 18.5566C15.7765 21.6347 10.643 23.0139 6.66556 21.2373C4.23895 20.1533 3.35352 18.0911 3.09957 15.7805C2.76842 12.7675 3.17129 9.99364 5.72106 7.82523C9.31242 4.77102 14.1406 4.39987 18.8285 4.65874C22.4053 4.85626 23.9386 9.02208 24.5533 11.7031C25.0819 14.0083 25.339 17.1504 24.1775 19.3461C23.2162 21.1631 21.9057 22.6426 20.3031 24.0394C18.4736 25.6339 16.6086 26.1831 14.0481 25.948C10.5002 25.6221 7.01136 23.7088 5.79816 20.604C4.30588 16.7849 4.5821 12.8879 8.41964 10.3497C10.8632 8.73361 14.4761 7.4654 17.5467 7.74715C21.6787 8.12631 23.4972 11.8616 24.0522 15.1385C24.3962 17.1698 24.4659 19.9947 22.7414 21.6103C20.87 23.3636 17.4344 23.0249 15.2143 22.1655C12.733 21.205 9.08458 19.0446 8.40037 16.4745C7.86524 14.4644 10.6056 14.0671 12.1398 14.5052C14.0229 15.043 15.6114 16.5739 15.9371 18.3484C16.3011 20.3312 14.2143 20.3491 12.7374 19.7017C12.1394 19.4397 10.4429 18.4218 11.6772 17.8539C12.3398 17.5491 12.9283 17.6193 13.6048 17.7411" stroke="#B74028" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="<?php echo esc_attr($classes['path-container']); ?>">
                <svg width="394" height="2719" viewBox="0 0 394 2719" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M114.5 1352.5C-37.5001 1385.5 -42.46 1653.26 162.054 1673.76M162.054 1673.76C180 1678.5 198.569 1666.53 192 1655C185.579 1643.73 158.5 1655.5 162.054 1673.76ZM162.054 1673.76C-14.4999 1875 162.054 2021.01 321.483 2042.79M321.483 2042.79C346.987 2053.01 349.874 2046.88 353.243 2042.79C360.461 2040.07 363.829 1994.46 332.551 2000.59C315.811 2008.22 316.671 2022.37 321.483 2042.79ZM321.483 2042.79C418.594 2189.4 388.977 2200.98 136.5 2226.5C49.0801 2238.75 20.0005 2257.5 16.5005 2317.5C16.5005 2376 -9.15889 2507.11 156.086 2517.2M13.4606 0.5C-7.30271 69.1415 3.12083 263.252 172.582 278.098M172.582 278.098C186.124 278.098 198.338 271.755 192.895 263.402C187.575 255.237 178.386 263.402 172.582 278.098ZM172.582 278.098C156.621 362.466 172.582 529.622 304.685 545.402M304.685 545.402C325.818 552.799 328.21 548.361 331.001 545.402C336.982 543.43 339.773 510.39 313.856 514.829C299.986 520.361 300.698 530.609 304.685 545.402ZM304.685 545.402C369.384 630.785 182.003 564.5 28.003 664.5C-31.8202 739.509 7.75038 902.134 165.919 912.227M156.086 2517.2C169.291 2517.2 181.201 2512.89 175.893 2507.21C170.706 2501.66 161.745 2507.21 156.086 2517.2ZM156.086 2517.2C140.522 2574.55 156.086 2688.17 284.902 2698.9M284.902 2698.9C305.509 2703.93 307.842 2700.91 310.563 2698.9C316.395 2697.56 328.273 2677.98 303 2681C289.475 2684.76 281.014 2688.84 284.902 2698.9ZM284.902 2698.9C264.5 2714.5 218 2718 200 2718M165.919 912.227C178.559 912.227 189.96 907.915 184.879 902.236C179.914 896.685 171.337 902.236 165.919 912.227ZM165.919 912.227C151.022 969.583 165.92 1083.22 289.22 1093.95M289.22 1093.95C308.945 1098.98 311.178 1095.96 313.783 1093.95C319.365 1092.61 330.734 1073.03 306.543 1076.05C294.1 1078.55 294.1 1084.55 289.22 1093.95ZM289.22 1093.95C264.73 1107.14 339.088 1172.56 306.543 1211.56C273.999 1250.57 363.783 1305.07 363.783 1305.07M363.783 1305.07C375.678 1317.21 384.78 1311.07 389.088 1305.07C393.395 1299.07 393.874 1292.57 389.088 1288.57C384.302 1284.57 373.165 1284.58 363.783 1305.07ZM363.783 1305.07L114.15 1352.58" stroke="#B74028" stroke-width="2" stroke-dasharray="4 4"/>
                </svg>
                </div>
            </div>
            <!-- content -->
            <div class="<?php echo esc_attr($classes['content-container']); ?>">
                <div class="<?php echo esc_attr($classes['point1']); ?>">
                    <h3 class="<?php echo esc_attr($classes['year2022']); ?>">2022</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point2']); ?>">
                    <h3 class="<?php echo esc_attr($classes['year2023']); ?>">2023</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point3']); ?>">
                    <h3 class="<?php echo esc_attr($classes['year2024']); ?>">2024</h3>
                </div>
                <div class="<?php echo esc_attr($classes['point4']); ?>">
                    <h3 class="<?php echo esc_attr($classes['year2025']); ?>">2025</h3>
                </div>
            </div>
        </div>
    </div>
</section>